{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from 'izitoast';\nimport \"izitoast/dist/css/iziToast.min.css\"\n\naxios.defaults.baseURL = \"https://pixabay.com/api/\";\n\nconst API_KEY = \"50173173-c7ebe87f992e3ee35ae0a4cd8\";\n\nexport async function getImagesByQuery(query, page) {\n  try {\n    const { data } = await axios(\"\", {\n      params: {\n        key: API_KEY,\n        q: query,\n        page,\n        per_page: \"15\",\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: \"true\",\n      }\n    });\n    return data;\n  }\n  catch (error) {\n    console.log(error);\n      iziToast.error({\n        title: 'Error',\n      });\n  } \n}","\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst galleryEl = document.querySelector('.gallery');\n\nconst simpleLightbox = new SimpleLightbox(\n  '.gallery .gallery-link', {captionsData: 'alt'}\n);\n\nexport function createGallery(images) {\n    const markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => \n        `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\"><img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n          <p>Likes <span>${likes}</span></p>\n          <p>Views <span>${views}</span></p>\n          <p>Comments <span>${comments}</span></p>\n          <p>Downloads <span>${downloads}</span></p>\n          </a>\n        </li>`\n  ).join(\"\");\n  galleryEl.insertAdjacentHTML('beforeend', markup);\n  simpleLightbox.refresh();\n}\n\nexport function clearGallery() {\n  galleryEl.innerHTML = \"\";\n}\n\nexport function showElement(element) {\n  element.classList.remove('hidden');\n}\n\nexport function hideElement(element) {\n  element.classList.add('hidden');\n}\n\n// export function showLoadMoreButton(element) {\n//   element.classList.remove('hidden');\n// }\n\n// export function hideLoadMoreButton(element) {\n//   element.classList.add('hidden');\n// }\n\n","import iziToast from 'izitoast';\nimport \"izitoast/dist/css/iziToast.min.css\"\n\nimport {getImagesByQuery} from './js/pixabay-api.js';\nimport {clearGallery, createGallery, hideElement, showElement} from './js/render-functions.js';\n\nconst formEl = document.querySelector('.form');\nconst searchText = formEl.querySelector('input[name=\"search-text]');\nconst submitBtn = formEl.querySelector('button');\nconst loader = document.querySelector('.loader');\nconst loaderMore = document.querySelector('.loader-more');\nconst loadBtn = document.querySelector('.load-more-btn');\n\nlet page = 1;\nlet lastPage = 0;\nlet searchItems = \"\";\n\nformEl.addEventListener('submit', fetchOnFormSubmit);\nloadBtn.addEventListener('click', loadPagesOnClick);\n\nasync function fetchOnFormSubmit(e) {\n    e.preventDefault();\n    clearGallery();\n    searchItems = e.target.elements['search-text'].value.trim();\n    page = 1;\n    if (searchItems === \"\") {\n        iziToast.warning({\n            title: 'Caution',\n            message: 'You forgot to type what you search',\n        });\n        return\n    }\n\n    showElement(loader);\n    \n    try {\n        const res = await getImagesByQuery(searchItems, page)\n        if (res.hits.length === 0) {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n            });\n            return\n        }\n        createGallery(res.hits);\n        if (res.totalHits <= 15) {\n            hideElement(loadBtn);\n        }\n        else {\n            showElement(loadBtn);\n        }\n        lastPage = Math.ceil(res.totalHits / 15);\n    } \n    catch (error) {\n        console.log(error)\n            iziToast.error({\n                message: error.message,\n            });\n    }\n    finally {\n            hideElement(loader);\n            formEl.reset();\n        }\n}\n\nasync function loadPagesOnClick() {\n    page += 1;\n    showElement(loaderMore);\n    try {\n        const res = await getImagesByQuery(searchItems, page)\n        \n        createGallery(res.hits);\n        if (lastPage <= page) {\n            hideElement(loadBtn);\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n            })\n        }\n        else {\n            showElement(loadBtn);\n        }\n        const listItemEl = document.querySelector('.gallery-item');\n        \n        const elementHeight = listItemEl.getBoundingClientRect().height;\n        window.scrollBy({\n            top: elementHeight * 2,\n            behavior: \"smooth\",\n          });\n    } \n    catch (error) {\n        console.log(error)\n            iziToast.error({\n                title: 'Error',\n                message: 'Illegal operation',\n            });\n    }\n    finally {\n            hideElement(loader);\n            hideElement(loaderMore);\n        }\n}"],"names":["axios","API_KEY","getImagesByQuery","query","page","data","error","iziToast","galleryEl","simpleLightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showElement","element","hideElement","formEl","loader","loaderMore","loadBtn","lastPage","searchItems","fetchOnFormSubmit","loadPagesOnClick","e","res","elementHeight"],"mappings":"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"}